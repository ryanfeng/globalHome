doctype html
html(lang='en')
    head
        include common/meta.jade
        title 浙江地球村环保科技有限公司-官网
        link(href='./css/home.css', rel='stylesheet')
        link(href='./css/common/video-js.min.css', rel='stylesheet')
    body
        include common/head.jade
        main
            article
                section#carousel-example-generic.hidden-xs.carousel.slide(data-ride='carousel')
                    ol.carousel-indicators
                        li.active(data-target='#carousel-example-generic', data-slide-to='0')
                        li(data-target='#carousel-example-generic', data-slide-to='1')
                        li(data-target='#carousel-example-generic', data-slide-to='2')
                    .carousel-inner.carousel1(role='listbox')
                        .item.active
                            a(href="./schoolDevice.html" target="_blank")
                                img.big-name.first-img(src='http://qnstatic.globalvillage.biz/hm-big1.png', alt='背景图')
                                .hm-time-anima
                                    .hm-time-block
                                        .home-img.hm-big1-bg.img-responsive(data-url="./images/hm-big1-bg.png")
                                        .home-img.hm-big1-reverse.img-responsive(data-url="./images/hm-big1-reverse1.png")
                        .item
                            a(href="./produceXF.html" target="_blank")
                                img.big-name(src='http://qnstatic.globalvillage.biz/hm-big2.png', alt='背景图')
                        .item
                            a(href="./business.html" target="_blank")
                                img.big-name(src='http://qnstatic.globalvillage.biz/hm-banner-3.png', alt='背景图')
                section#carousel-example-generic-mobile.carousel.slide.visible-xs-inline-block(data-ride='carousel')
                    .carousel-inner.carousel1(role='listbox')
                        .item.active
                            a(href="./schoolDevice.html" target="_blank")
                                img.big-name.first-img(src='../images/hm-mobile-big1.png', alt='背景图')
                                .hm-time-anima
                                    .hm-time-block
                                        .home-img.hm-big1-bg.img-responsive(data-url="./images/hm-big1-bg.png")
                                        .home-img.hm-big1-reverse.img-responsive(data-url="./images/hm-big1-reverse1.png")
                        .item
                            a(href="./produceXF.html" target="_blank")
                                img.big-name(src='http://qnstatic.globalvillage.biz/hm-mobile-big2.png', alt='背景图')
                        .item
                            a(href="./business.html" target="_blank")
                                img.big-name(src='http://qnstatic.globalvillage.biz/bus-small-1-v1.png', alt='背景图')
                    a.left.carousel-control(href='#carousel-example-generic-mobile', role='button', data-slide='prev').visible-xs-inline-block
                        span.glyphicon.glyphicon-chevron-left
                        span.sr-only Previous
                    a.right.carousel-control(href='#carousel-example-generic-mobile', role='button', data-slide='next').visible-xs-inline-block
                        span.glyphicon.glyphicon-chevron-right
                        span.sr-only Next
            article.container.news
                div.new-title
                    | 新闻资讯<br>
                    label
                    br
                    span NEWS   CENTER
                div.row
                    section.col-sm-4
                        .new-block.new-block1
                            a(href='news.html?id=39' target='_blank')
                                .img-responsive.img-bg(style="background-image: url('http://oisl737do.bkt.clouddn.com/bc80897fba804458bf4e978814cec59c.png?e=1549794175&token=zTof-q0UNUTxS0aBdY6DHOIbtSCS_J5lx4Qf1vzW:odM3iHLqT3182l4DHzefrdpcHGI=');")
                                h2 捐赠1000万的新风设备用于改善杭州地区学校的教室空气质量
                                p.new-con 2016年9月25日，《2016中国新西兰可持续发展教育论坛》（以下简称论坛）在中国杭州低碳科技馆举行并取得圆满成功。地球村捐赠价值1000万的新风设备用于改善杭州地区学校的教室空气质量。
                                p.new-block
                                    label.new-time-img.data-img
                                    span 2017-02-17
                    section.col-sm-4
                        .new-block.new-block1
                            a(href='news.html?id=40' target='_blank')
                                .img-responsive.img-bg(style="background-image: url('http://oisl737do.bkt.clouddn.com/8d07f9b5bf654d3f93d4a4c89eb5a432.jpg?e=1549794750&token=zTof-q0UNUTxS0aBdY6DHOIbtSCS_J5lx4Qf1vzW:Wt9Mehtl1-gC4qFmL1WgxgREQqQ=');")
                                h2 地球村“环保示范学校”—— 杭州市时代小学篇
                                p.new-con 2016年9月10日，暨第32个教师节之际，地球村用实际行动给学校送了一份大礼。上午9时，浙江地球村环保科技有限公司与杭州市时代小学，在杭州时代小学举办“环保示范学校”落地仪式。
                                p.new-block
                                    label.new-time-img.data-img
                                    span 2017-02-17
                    section.col-sm-4
                        .new-block.new-block1
                            a(href='news.html?id=41' target='_blank')
                                .img-responsive.img-bg(style="background-image: url('http://oisl737do.bkt.clouddn.com/b51cff1203b242a4b6833093ee7aeefc.jpg?e=1549795113&token=zTof-q0UNUTxS0aBdY6DHOIbtSCS_J5lx4Qf1vzW:hKQn3GNqbeXNtKKvPOOrkalIWxM=');")
                                h2 地球村荣获杭州市高新技术企业称号
                                p.new-con 根据《杭州市高新技术企业认定工作的实施意见》（杭政办函〔2007〕352号）等文件精神，经审定，浙江地球村环保科技有限公司荣获2016年杭州市第一批高新技术企业称号。
                                p.new-block
                                    label.new-time-img.data-img
                                    span 2017-02-17
                div(style="text-align: center;")
                    a(href="./news_list.html" alt="更多新闻资讯" style="color: #34bfe0; display:inline-block;margin-top:40px" )
                        .button 浏览更多
            article.all
                .container.video
                    .new-title
                        | 视频中心<br>
                        label
                        br
                        span VEDIO   CENTER
                    .row
                        .col-sm-12.video
                            video(id="video" class="video-js vjs-default-skin vjs-big-play-centered" controls
                            preload="none" loop poster="./images/home/video-1.jpg")
                                source(src="http://qnstatic.globalvillage.biz/video/qy.mp4" type="video/mp4")
                    .row.sm-blocK
                        section.col-sm-4
                            .new-block(onclick="disShowBlock('video1')")
                                img.poster-img.data-img(data-url="./images/home/hs.png")
                                .poster-bt
                                p(onclick="disShowBlock('video1')") 地球村COO接受新锐杭商采访
                        section.col-sm-4
                            .new-block(onclick="disShowBlock('video2')")
                                img.poster-img.data-img(data-url="./images/home/tl.png")
                                .poster-bt
                                p(onclick="disShowBlock('video2')") 地球村CEO受邀钱塘论坛
                        section.col-sm-4
                            .new-block(onclick="disShowBlock('video3')")
                                img.poster-img.data-img(data-url="./images/home/ys.png")
                                .poster-bt
                                p(onclick="disShowBlock('video3')") 地球村COO接受杭州影视新闻采访
        mark.mask
            .closeBack
            video(id="video1" class="video1 videoNal video-js vjs-default-skin vjs-big-play-centered" controls preload="none")
                source(src="http://qnstatic.globalvillage.biz/video/hs.mp4" type="video/mp4")
            video(id="video2" class="video2 videoNal video-js vjs-default-skin vjs-big-play-centered" controls preload="none")
                source(src="http://qnstatic.globalvillage.biz/video/tl.mp4" type="video/mp4")
            video(id="video3" class="video3 videoNal video-js vjs-default-skin vjs-big-play-centered" controls preload="none" data-setup="{}" )
                source(src="http://qnstatic.globalvillage.biz/video/ys.mp4" type="video/mp4")
        include common/foot.jade
        script.
            //首页大图动画图片大小
            $(document).ready(function () {
                if ($(window).width() < 768) {
                    changeItem(0.549);
                } else {
                    changeItem(0.3695324283);
                }

                function changeItem(number) {
                    $(".hm-time-block").width($(document).width() * number);
                    $(".hm-time-block").height($(".hm-time-block").width());
                    $(window).resize(function () {
                        $(".hm-time-block").width($(document).width() * number);
                        $(".hm-time-block").height($(".hm-time-block").width());
                    });
                }
            });

            //视屏播放处理
            (function () {
                var video, video1, video2, video3;
                loadVideo();
                //延迟加载处理
                $(window).scroll(function () {
                    if (!video) {
                        loadVideo();
                    }
                });

                //加载视屏js库
                function loadVideo() {
                    if ($(document).scrollTop() > 588) {
                        var element = document.createElement("script");
                        element.src = 'http://qnstatic.globalvillage.biz/js/video.min.js';
                        document.body.appendChild(element);
                        element.onload = element.onreadystatechange = function () {
                            if (!this.readyState || this.readyState == 'loaded' || this.readyState == 'complete') {
                                initVideo();
                            }
                            element.onload = element.onreadystatechange = null;
                        }
                    }
                }

                //视频模块初始化
                function initVideo() {
                    video = videojs("video");
                    video1 = videojs("video1");
                    video2 = videojs("video2");
                    video3 = videojs("video3");
                    //关闭视屏
                    $(".closeBack").on('click', function () {
                        video1.pause();
                        video2.pause();
                        video3.pause();
                        $("#video1").hide();
                        $("#video2").hide();
                        $("#video3").hide();
                        $(".mask").hide();
                    })
                }

                //播放弹出框视屏但是暂停主视屏
                function disShowBlock(idName) {
                    $("#" + idName).show();
                    videojs(idName).play();
                    $(".mask").show();
                    video.pause();
                }

                window.disShowBlock = disShowBlock;
            }());

            //移动发端滑动效果
            if ($(window).width() < 768) {
                var element = document.createElement("script");
                element.src = './js/plugin/touch-0.2.14.min.js';
                document.body.appendChild(element);
                element.onload = element.onreadystatechange = function () {
                    if (!this.readyState || this.readyState == 'loaded' || this.readyState == 'complete') {
                        touch.on('#carousel-example-generic-mobile .item', 'swipeleft', function (ev) {
                            $('#carousel-example-generic-mobile').carousel('next');
                        });
                        touch.on('#carousel-example-generic-mobile .item', 'swiperight', function (ev) {
                            $('#carousel-example-generic-mobile').carousel('prev');
                        });
                    }
                    element.onload = element.onreadystatechange = null;
                }
            }

            //获取资讯列表
            $.ajax({
                url: 'http://cloud.globalvillage.biz/dqcCms/news/list',
                contentType: "application/json",
                type: 'post',
                data: JSON.stringify({
                    isBanner: 0,
                    siteKey: "website",
                    status: 1,
                    pageNum: 1,
                    pageSize: 10
                }),
                dataType: 'json',
                success: function (listObj) {
                    new Vue({
                        el: '.news',
                        data: {
                            items: listObj.data,
                            styleObject: function (imgUrl) {
                                console.log(imgUrl)
                                return {'background-image': "url(" + imgUrl + ")"}
                            }
                        }
                    })
                },
                error: function () {
                    alert("不好意思，服务器不听话了！");
                }
            })
